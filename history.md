# LuaSTG Sub 更新历史记录

* LuaSTG Sub v0.20.9
    * 引擎基础
        * 更新：`dear-imgui` 更新到 1.89.6
    * 图形/渲染
        * 修复：修复了 `lstg.LoadTTF` 加载矢量字体时，如果加载失败不会返回 `false` 的问题
        * 修改：改进了对现代交换链模型、桌面合成引擎功能是否可用的判断方式，现在会通过 `D3DKMT` 系列 API 获取更多设备功能信息并进行判断，以进一步提升设备兼容性
* LuaSTG Sub v0.20.8
    * 引擎基础
        * 新增：如果系统支持（Windows 10 1803+），将启用新的稳定帧率控制器，替代原有的限速帧率控制器（仅限制帧率，不进行补偿），新的帧率控制器的目标是补偿每帧的时间误差，尽可能让画面显示更稳定，减少画面抖动
    * 图形/渲染
        * 修复：有时候切换到别的窗口再回来，会出现掉帧、延迟升高等问题，现在理论上修复了（微软你就说这个是不是没修完的 bug 吧，老版本 Windows 10 就有的 bug，虽然说是在某个补丁中修复了，但是看起来 bug 还是能通过特殊方式触发）（微软：我修复了大部分帧延迟的问题，但是我保留了一部分，我觉得保留一部分特性才知道你用的是 Windows 10+）
* LuaSTG Sub v0.20.7
    * 资源管理
        * 修改：使用性能、质量更高的 `xxhash` 库来计算资源名称 hash 值
    * 游戏对象
        * 移除：移除 LuaSTG Ex Plus 为游戏对象添加的 `pause` 和 `rmove` 属性，这两个属性使用量及其稀少，但却容易误用并导致难以察觉的问题
    * Lua 拓展库
        * 修复：修复 `lfs` 文件系统库中有一个未捕获的异常的问题
* LuaSTG Sub v0.20.6
    * 引擎基础
        * 更新：更新 `luajit` 库，现在 `luajit` 支持捕获 `__gc` 元方法的错误
    * 图形/渲染
        * 修改：现在程序启动时如果检测不到可用的显卡硬件，将会弹窗报错并显示明确的原因
        * 修改：现在允许使用软件显示适配器（在没有显卡硬件的情况下）运行 LuaSTG Sub，需要指定 `--allow-soft-adapter` 命令行参数，需要注意的是软件显示适配器性能不足以流畅运行程序，仅用于开发、测试、临时或应急情况下使用
        * 修改：当窗口和画布的宽度或高度相等，且窗口尺寸大于或等于画布尺寸时，使用速度更快的直接复制而不是常规渲染来显示画面
    * Lua 拓展库
        * 新增：新增 `luasocket` 网络库，需要注意的是仅包含 `socket.core` 模块，lua 脚本部分请从 `luasocket` 官方仓库获取
* LuaSTG Sub v0.20.5
    * 平台
        * 修改：现在要求 Windows 7 操作系统必须安装 `KB2533623` 补丁（或者后继替代该补丁的其他补丁）
    * 图形/渲染
        * 修改：内置的基本渲染器所使用的着色器预编译为字节码，不再在运行时动态编译
        * 修改：着色器编译库 `d3dcompiler_47.dll` 已改为按需加载，如果开发者没有用到模型渲染功能或者后处理特效功能，那么将不会加载
    * 音频
        * 修复：切换音频设备后，背景音乐不会继续播放
    * Lua 虚拟机
        * 修复：由于（未知的）历史原因，之前仅提供 `?.lua` 搜索路径，未默认提供 `?/init.lua` 搜索路径，现在已补上缺失的 `?/init.lua` 搜索路径
    * 游戏对象
        * 修复：修复了 `dx`、`dy` 的值在游戏对象创建后第 1 帧可能计算不正确的未定义行为，触发的原因是第 0 帧生成时记录 `lastx`、`lasty` 在 `lstg.New` 函数调用返回前，如果随后修改了游戏对象的 `x`、`y` 坐标，将导致记录的 `lastx`、`lasty` 并非期望的值
        * 修复：修复了 `lstg.BoxCheck` 不包含边界的问题，并去除了意味不明的单参数重载
* LuaSTG Sub v0.20.4
    * 音频
        * 修改：现在音频系统支持从错误中恢复，或者在无音频设备的计算机上以空白模式继续运行
* LuaSTG Sub v0.20.3
    * 引擎基础
        * 修改：现在可以通过配置文件来指定 `log` 日志文件的储存位置，详情请参考 `doc/specification/引擎配置文件.md` 文档
    * 数学
        * 修改：随机数发生器 `lstg.Rand:Int` 和 `lstg.Rand:Float` 方法不再要求第二个参数大于或等于第一个参数
* LuaSTG Sub v0.20.2
    * 窗口
        * 修复：修复了按住 `Alt` 键的同时切换到别的窗口后会导致引擎一直以为 `Alt` 键处于按下状态
    * 图形/渲染
        * 修复：修复了 `lstg.Render`、`lstg.RenderRect`、`lstg.Render4V`、`lstg.RenderAnimation` 在找不到资源时不抛出错误的问题
* LuaSTG Sub v0.20.1
    * 引擎基础
        * 移除：不再使用 `fancylib` 库
